(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var o=e.g.document;if(!t&&o&&(o.currentScript&&"SCRIPT"===o.currentScript.tagName.toUpperCase()&&(t=o.currentScript.src),!t)){var n=o.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=n[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=e=>{e.preventDefault()},o=(e,t)=>{const o=e.querySelector(t.submitButtonSelector),n=e.checkValidity();o.disabled=!n,o.classList.toggle("popup__button_disabled",!n)};var n;e.p,e.p;const r=document.querySelector(".popup_type_profile"),a=document.querySelector(".profile__edit-buton"),c=r.querySelector(".popup__form_type_profile"),p=document.querySelector(".profile-info__title"),i=document.querySelector(".profile-info__intro"),s=document.querySelector(".popup__input_type_name"),l=document.querySelector(".popup__input_type_job"),u=document.querySelector(".profile__avatar"),d=document.querySelector(".popup_type_avatar"),_=d.querySelector(".popup__form_type_avatar"),m=document.querySelector(".popup__input_type_linka"),h=document.querySelector(".popup_type_place"),y=document.querySelector(".profile__add-button"),f=h.querySelector(".popup__form_type_place"),b=h.querySelector(".popup__input_type_title"),v=h.querySelector(".popup__input_type_link"),S=document.querySelector(".popup_type_image"),g=document.querySelector(".popup__img"),C=document.querySelector(".popup__name"),E=document.querySelectorAll(".popup__button-close"),q=document.querySelectorAll(".popup"),L=document.querySelector(".template-card").content,k=document.querySelector(".elements"),x=e=>{const t=L.cloneNode(!0),o=t.querySelector(".element__title"),r=t.querySelector(".element__img"),a=t.querySelector(".element__button"),c=t.querySelector(".element__basket");e.owner._id!==n&&(c.style.display="none");const p=t.querySelector(".element__button_like");return o.textContent=e.name,r.src=e.link,r.alt=e.alt,p.textContent=e.likes.length,T(r),i=a,s=e._id,l=p,i.addEventListener("click",(e=>{e.target.classList.toggle("element__button_active"),e.target.classList.contains("element__button_active")?function(e,t){fetch(`https://nomoreparties.co/v1/frontend-st-cohort-201/cards/likes/${e}`,{method:"PUT",headers:{authorization:"588d31a2-aacb-4a5b-b164-4d6e90b68f48","Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{t.textContent=e.likes.length}))}(s,l):function(e,t){fetch(`https://nomoreparties.co/v1/frontend-st-cohort-201/cards/likes/${e}`,{method:"DELETE",headers:{authorization:"588d31a2-aacb-4a5b-b164-4d6e90b68f48 ","Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{t.textContent=e.likes.length}))}(s,l)})),((e,t)=>{e.addEventListener("click",(e=>{console.log(t),function(e){fetch(`https://nomoreparties.co/v1/frontend-st-cohort-201/cards/${e}`,{method:"DELETE",headers:{authorization:"588d31a2-aacb-4a5b-b164-4d6e90b68f48 ","Content-Type":"application/json"}})}(t),e.target.closest(".element").remove()}))})(c,e._id),console.log(e),console.log(n),t;var i,s,l},T=e=>{e.addEventListener("click",(t=>{j(S),g.src=e.src,g.alt=e.alt,C.textContent=t.target.closest(".element").textContent}))};u.addEventListener("click",(e=>{j(d)}));const j=e=>{e.classList.add("popup_opened"),document.addEventListener("keydown",w)},$=e=>{e.classList.remove("popup_opened"),document.removeEventListener("keydown",w)},w=e=>{"Escape"===e.key&&q.forEach((e=>{$(e)}))};a.addEventListener("click",(()=>{j(r),s.value=p.textContent,l.value=i.textContent})),c.addEventListener("submit",(e=>{const t=e.target.querySelector(".popup__button-submit"),o=t.textContent;t.textContent="Сохраняю...",console.log("OTPRAVIL.."),function(e,t,o,n){fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/users/me",{method:"PATCH",headers:{authorization:"588d31a2-aacb-4a5b-b164-4d6e90b68f48 ","Content-Type":"application/json"},body:JSON.stringify({name:`${e}`,about:`${t}`})}).then((e=>e.json())).then((e=>{z()})).finally((()=>{o.textContent=n}))}(s.value,l.value,t,o),$(r),e.preventDefault()})),_.addEventListener("submit",(e=>{console.log("OTPRAVIL..");const t=e.target.querySelector(".popup__button-submit"),o=t.textContent;t.textContent="Сохраняю...",function(e,t,o){fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/users/me/avatar",{method:"PATCH",headers:{authorization:"588d31a2-aacb-4a5b-b164-4d6e90b68f48 ","Content-Type":"application/json"},body:JSON.stringify({avatar:`${e}`})}).then((e=>e.json())).then((e=>{u.src=e.avatar})).finally((()=>{t.textContent=o}))}(m.value,t,o),$(d),e.preventDefault()})),E.forEach((e=>{e.addEventListener("click",(e=>{const t=A(e);$(t)}))})),q.forEach((e=>{e.addEventListener("click",(e=>{if(e.target===e.currentTarget){const t=A(e);$(t)}}))})),y.addEventListener("click",(()=>{j(h),b.value="",v.value=""})),f.addEventListener("submit",(e=>{const t=e.target.querySelector(".popup__button-submit"),o=t.textContent;var r;t.textContent="Сохраняю...",r={name:b.value,link:v.value,likes:[],owner:{_id:`${n}`}},k.prepend(x(r)),function(e,t,o,n){fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/cards",{method:"POST",headers:{authorization:"588d31a2-aacb-4a5b-b164-4d6e90b68f48 ","Content-Type":"application/json"},body:JSON.stringify({name:`${e}`,link:`${t}`})}).then((e=>e.json())).finally((()=>{o.textContent=n}))}(b.value,v.value,t,o),e.target.reset(),$(h)}));const A=e=>e.target.closest(".popup");function z(){fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/users/me ",{headers:{authorization:"588d31a2-aacb-4a5b-b164-4d6e90b68f48"},method:"GET"}).then((e=>e.json())).then((e=>{console.log(e),p.textContent=e.name,i.textContent=e.about,u.src=e.avatar,n=e._id}))}var P;z(),fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/cards",{headers:{authorization:"588d31a2-aacb-4a5b-b164-4d6e90b68f48"},method:"GET"}).then((e=>e.json())).then((e=>{e.forEach((e=>{k.append(x(e))}))})),P={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},Array.from(document.querySelectorAll(P.formSelector)).forEach((e=>{e.addEventListener("submit",t),e.addEventListener("input",(()=>{o(e,P)})),((e,t)=>{Array.from(e.querySelectorAll(t.inputSelector)).forEach((function(e){e.addEventListener("input",(e=>{((e,t)=>{const o=e.target,n=o.id,r=document.querySelector(`#${n}-error`);o.validity.valid?(o.classList.remove(t.inputErrorClass),r.textContent=""):(o.classList.add(t.inputErrorClass),r.textContent=o.validationMessage)})(e,t)}))}))})(e,P),o(e,P)}))})();